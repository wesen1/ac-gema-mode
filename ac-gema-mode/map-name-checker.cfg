//
// @author wesen
// @copyright 2017 wesen <wesen-ac@web.de>
//

//
// Map name checker module for ac-gema-mode
//
// Checks whether a map name is a gema map name
//

persistidents 0;

const gemaMapNameImplicits ["jigsaw" "deadmeat-10"];
const gemaMapNameCodes ["g" "3e" "m" "a@4"];


//
// Returns whether a map name is a gema map name.
//
// @param String $arg1 The map name
//
// @return int 0: Map name is not a gema map name
//             1: Map name is a gema map name
//
const isGemaMapName [

  if (|| (containsGemaMapNameImplicit (tolower $arg1)) (containsGemaMapNameCodes (tolower $arg1))) [
    return 1;
  ][
    return 0;
  ]

]

//
// Checks whether a map name contains one of the implicit words.
//
// @param String $arg1 The map name
//
// @return int 0: Map name contains one of the implicit words
//             1: Map name does not contain any of the implicit words
//
const containsGemaMapNameImplicit [

  mapNameCheckerTmpReturnValue = 0;

  looplist $gemaMapNameImplicits gemaMapNameImplicit [

    if (strstr $arg1 $gemaMapNameImplicit) [
      mapNameCheckerTmpReturnValue = 1;
      break;
    ]

  ]

  return $mapNameCheckerTmpReturnValue;

]

//
// Checks whether a map name contains ge3ma@4.
//
// @param String $arg1 The map name
//
// @return int 0: Map name contains ge3ma@4
//             1: Map name does not contain ge3ma@4
//
const containsGemaMapNameCodes [

  alias gemaMapNameMatches;

  loop i (+ 1 (- (strlen $arg1) (listlen $gemaMapNameCodes))) [

    gemaMapNameMatches = 0;

    loop j (listlen $gemaMapNameCodes) [

      checkMapNameLetter = (substr $arg1 (+ $i $j) 1);

      parsestring (at $gemaMapNameCodes $j) gemaMapNameCodeLetter [

        if (strcmp $gemaMapNameCodeLetter $checkMapNameLetter) [
          gemaMapNameMatches = 1;
          breakparse;
        ][
          gemaMapNameMatches = 0;
        ]

      ]

      // Stop checking as soon as one code letter is missing
      if (! $gemaMapNameMatches) [
        break;
      ]

    ]

    // Stop checking when one complete code was found in the map name
    if ($gemaMapNameMatches) [
      break;
    ]

  ]

  return $gemaMapNameMatches;

]

